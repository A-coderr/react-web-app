{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CombinedChannel = void 0;\nconst base_1 = require(\"./base\");\nfunction collectConnections(children) {\n  const mappings = new WeakMap();\n  const connections = [];\n  children.forEach(channel => {\n    channel.connections.forEach(connection => {\n      if (!mappings.has(connection)) {\n        connections.push(connection);\n        mappings.set(connection, channel.data);\n      }\n    });\n  });\n  return {\n    connections,\n    mappings\n  };\n}\nclass CombinedChannel extends base_1.Channel {\n  constructor(children, data = null) {\n    const {\n      mappings,\n      connections\n    } = collectConnections(children);\n    super(connections, data);\n    this.children = children;\n    this.mappings = mappings;\n  }\n  refresh() {\n    const collected = collectConnections(this.children);\n    return Object.assign(this, collected);\n  }\n  leave(...connections) {\n    return this.callChildren('leave', connections);\n  }\n  join(...connections) {\n    return this.callChildren('join', connections);\n  }\n  dataFor(connection) {\n    return this.mappings.get(connection);\n  }\n  callChildren(method, connections) {\n    this.children.forEach(child => child[method](...connections));\n    this.refresh();\n    return this;\n  }\n}\nexports.CombinedChannel = CombinedChannel;","map":{"version":3,"names":["base_1","require","collectConnections","children","mappings","WeakMap","connections","forEach","channel","connection","has","push","set","data","CombinedChannel","Channel","constructor","refresh","collected","Object","assign","leave","callChildren","join","dataFor","get","method","child","exports"],"sources":["C:\\Users\\VARLab ROG 1\\Documents\\workspace\\web\\react-frontend\\node_modules\\@feathersjs\\transport-commons\\src\\channels\\channel\\combined.ts"],"sourcesContent":["import { RealTimeConnection } from '@feathersjs/feathers'\nimport { Channel } from './base'\n\nfunction collectConnections(children: Channel[]) {\n  const mappings = new WeakMap<RealTimeConnection, any>()\n  const connections: RealTimeConnection[] = []\n\n  children.forEach((channel) => {\n    channel.connections.forEach((connection) => {\n      if (!mappings.has(connection)) {\n        connections.push(connection)\n        mappings.set(connection, channel.data)\n      }\n    })\n  })\n\n  return { connections, mappings }\n}\n\nexport class CombinedChannel extends Channel {\n  children: Channel[]\n  mappings: WeakMap<RealTimeConnection, any>\n\n  constructor(children: Channel[], data: any = null) {\n    const { mappings, connections } = collectConnections(children)\n\n    super(connections, data)\n\n    this.children = children\n    this.mappings = mappings\n  }\n\n  refresh() {\n    const collected = collectConnections(this.children)\n\n    return Object.assign(this, collected)\n  }\n\n  leave(...connections: RealTimeConnection[]) {\n    return this.callChildren('leave', connections)\n  }\n\n  join(...connections: RealTimeConnection[]) {\n    return this.callChildren('join', connections)\n  }\n\n  dataFor(connection: RealTimeConnection) {\n    return this.mappings.get(connection)\n  }\n\n  private callChildren(method: string, connections: RealTimeConnection[]) {\n    this.children.forEach((child: any) => child[method](...connections))\n    this.refresh()\n\n    return this\n  }\n}\n"],"mappings":";;;;;;AACA,MAAAA,MAAA,GAAAC,OAAA;AAEA,SAASC,kBAAkBA,CAACC,QAAmB;EAC7C,MAAMC,QAAQ,GAAG,IAAIC,OAAO,EAA2B;EACvD,MAAMC,WAAW,GAAyB,EAAE;EAE5CH,QAAQ,CAACI,OAAO,CAAEC,OAAO,IAAI;IAC3BA,OAAO,CAACF,WAAW,CAACC,OAAO,CAAEE,UAAU,IAAI;MACzC,IAAI,CAACL,QAAQ,CAACM,GAAG,CAACD,UAAU,CAAC,EAAE;QAC7BH,WAAW,CAACK,IAAI,CAACF,UAAU,CAAC;QAC5BL,QAAQ,CAACQ,GAAG,CAACH,UAAU,EAAED,OAAO,CAACK,IAAI,CAAC;MACxC;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,OAAO;IAAEP,WAAW;IAAEF;EAAQ,CAAE;AAClC;AAEA,MAAaU,eAAgB,SAAQd,MAAA,CAAAe,OAAO;EAI1CC,YAAYb,QAAmB,EAAEU,IAAA,GAAY,IAAI;IAC/C,MAAM;MAAET,QAAQ;MAAEE;IAAW,CAAE,GAAGJ,kBAAkB,CAACC,QAAQ,CAAC;IAE9D,KAAK,CAACG,WAAW,EAAEO,IAAI,CAAC;IAExB,IAAI,CAACV,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,QAAQ,GAAGA,QAAQ;EAC1B;EAEAa,OAAOA,CAAA;IACL,MAAMC,SAAS,GAAGhB,kBAAkB,CAAC,IAAI,CAACC,QAAQ,CAAC;IAEnD,OAAOgB,MAAM,CAACC,MAAM,CAAC,IAAI,EAAEF,SAAS,CAAC;EACvC;EAEAG,KAAKA,CAAC,GAAGf,WAAiC;IACxC,OAAO,IAAI,CAACgB,YAAY,CAAC,OAAO,EAAEhB,WAAW,CAAC;EAChD;EAEAiB,IAAIA,CAAC,GAAGjB,WAAiC;IACvC,OAAO,IAAI,CAACgB,YAAY,CAAC,MAAM,EAAEhB,WAAW,CAAC;EAC/C;EAEAkB,OAAOA,CAACf,UAA8B;IACpC,OAAO,IAAI,CAACL,QAAQ,CAACqB,GAAG,CAAChB,UAAU,CAAC;EACtC;EAEQa,YAAYA,CAACI,MAAc,EAAEpB,WAAiC;IACpE,IAAI,CAACH,QAAQ,CAACI,OAAO,CAAEoB,KAAU,IAAKA,KAAK,CAACD,MAAM,CAAC,CAAC,GAAGpB,WAAW,CAAC,CAAC;IACpE,IAAI,CAACW,OAAO,EAAE;IAEd,OAAO,IAAI;EACb;;AApCFW,OAAA,CAAAd,eAAA,GAAAA,eAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}